<!DOCTYPE html>
<html>
<script src="js/auth.js"></script>

<head>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    {{template "style"}}
    <title>Local DashBoard</title>
    <script>
        function textFirstCharCapitalize(value){
              return value.replace(".", " ").replace(/\b\w/g, l => l.toUpperCase());
        }
    </script>
</head>

<body>
    {{template "contextSwitch" .}} {{template "navigator" }}
     
    {{ range $base :=.ResultList }}
    <h1 style="justify-content: center; text-align: center;" ><span style="color: green;">{{ $base.Name }}</span> - {{ $base.Namespace }} </h1>
 
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
        {{ range $key, $value := .ResourceMap }}
        <div id="{{$key}}" style="width: 100%; height: 500px;"></div>
        <script>
            (function () {
                var colors = ['#c23531', '#2f4554', '#61a0a8', '#d48265', '#91c7ae', '#749f83', '#ca8622', '#bda29a', '#6e7074', '#546570', '#c4ccd3'];
                var chartDom = document.getElementById('{{$key}}');
                var myChart = echarts.init(chartDom);
                var data = [
                    { value: '{{$value.Used}}', name: 'Used' },
                    { value: '{{$value.Free}}', name: 'Free' }
                ];

                data.forEach(function (item) {
                    item.itemStyle = {
                        color: colors[Math.floor(Math.random() * colors.length)]
                    };
                });

                var option = {
                    title: {
                        text: textFirstCharCapitalize("{{$key}}"),
                        left: 'center'
                    },
                    tooltip: {
                        trigger: 'item'
                    },
                    series: [
                        {
                            name: textFirstCharCapitalize("{{$key}}") + " Resource Usage - Total : {{$value.Hard}}",
                            type: 'pie',
                            radius: '60%',
                            data: data,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            },
                            label: {
                                formatter: '{b}: {d}%'
                            }
                        }
                    ]
                };

                myChart.setOption(option);
            })();
        </script>
        {{end}}
    </div>
    {{end}}
</body>

</html>